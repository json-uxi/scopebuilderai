<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ScopeBuilderAI ‚Äî White-Label Admin</title>
  <meta name="description" content="Customize your white-label proposal generator branding and settings." />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; font-family: 'Inter', system-ui, sans-serif; background:#f8fafc; color:#0f172a; }
    .auth-container { max-width: 420px; margin: 60px auto; padding: 32px; background:#fff; border-radius:16px; box-shadow: 0 12px 44px rgba(0,0,0,0.08); }
    .auth-container h2 { margin: 0 0 18px; font-size: 24px; font-weight: 900; color:#1e3a8a; }
    .form-group { margin-bottom: 14px; }
    .form-group label { display:block; font-weight:800; font-size:13px; color:#334155; margin-bottom:6px; }
    .form-group input { width:100%; padding:12px; border:1.5px solid #e2e8f0; border-radius:8px; font-size:14px; font-weight:700; }
    .form-group input:focus { outline:none; border-color:#1e3a8a; box-shadow:0 0 0 3px rgba(30,58,138,0.1); }
    .auth-btn { width:100%; padding:12px; background:#1e3a8a; color:#fff; border:none; border-radius:8px; font-weight:900; cursor:pointer; font-size:14px; }
    .auth-btn:hover { filter:brightness(1.08); }
    .auth-error { color:#dc2626; font-size:13px; margin-top:10px; min-height:18px; }
    .admin-container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    .admin-header { display:flex; justify-content:space-between; align-items:center; margin-bottom: 24px; padding-bottom: 16px; border-bottom:1px solid #e2e8f0; }
    .admin-header h1 { margin:0; font-size:26px; font-weight:900; color:#1e3a8a; }
    .logout-btn { padding:10px 16px; background:#dc2626; color:#fff; border:none; border-radius:8px; font-weight:800; cursor:pointer; }
    .admin-grid { display:grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    .admin-card { background:#fff; border:1px solid #e2e8f0; border-radius:12px; padding:20px; }
    .admin-card h3 { margin:0 0 12px; font-size:18px; font-weight:900; }
    .color-picker-group { display:flex; gap:12px; align-items:center; margin-bottom:10px; }
    .logo-upload { display:flex; gap:12px; align-items:flex-start; margin-bottom: 10px; }
    .logo-preview { width:80px; height:80px; border:1px solid #e2e8f0; border-radius:8px; background:#f1f5f9; display:flex; align-items:center; justify-content:center; overflow:hidden; }
    .logo-preview img { max-width:100%; max-height:100%; }
    .save-btn { width:100%; padding:12px; background: linear-gradient(135deg,#1e3a8a,#2563eb); color:#fff; border:none; border-radius:8px; font-weight:900; cursor:pointer; font-size:14px; }
    .save-message { margin-top:10px; padding:10px; border-radius:8px; text-align:center; font-weight:800; font-size:13px; display:none; }
    .save-success { background:#dcfce7; color:#166534; }
    .save-error { background:#fee2e2; color:#991b1b; }
    @media (max-width: 900px) { .admin-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>

  <!-- Auth -->
  <div id="authSection" class="auth-container">
    <h2>White-Label Admin</h2>
    <form id="loginForm">
      <div class="form-group">
        <label for="email">Agency Email</label>
        <input type="email" id="email" placeholder="your@agency.com" required />
      </div>
      <div class="form-group">
        <label for="password">Password</label>
        <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />
      </div>
      <button type="submit" class="auth-btn">Sign In</button>
      <div id="authError" class="auth-error"></div>
    </form>
    <p style="text-align:center; margin-top:12px; font-size:13px; color:#64748b;">
      New agency? <a href="#" onclick="toggleSignUp()" style="color:#1e3a8a; font-weight:800; text-decoration:none;">Create Account</a>
    </p>
  </div>

  <!-- Dashboard -->
  <div id="adminDashboard" style="display:none;">
    <div class="admin-container">
      <div class="admin-header">
        <h1>Customize Your Branding</h1>
        <button class="logout-btn" onclick="logout()">Logout</button>
      </div>

      <div class="admin-grid">
        <!-- Branding -->
        <div class="admin-card">
          <h3>üé® Branding</h3>
          <div class="logo-upload">
            <input type="file" id="logoFile" accept="image/png,image/jpeg" onchange="previewLogo()" />
            <div class="logo-preview">
              <img id="logoImg" src="" alt="Logo" style="display:none;" />
              <span id="logoPlaceholder" style="color:#94a3b8; font-size:12px;">No logo</span>
            </div>
          </div>

          <div class="form-group">
            <label>Site Title</label>
            <input type="text" id="siteTitle" placeholder="Your Agency Proposals" value="ScopeBuilderAI" />
          </div>

          <div class="form-group">
            <label>Tagline</label>
            <input type="text" id="tagline" placeholder="Professional Proposal Generator" value="Professional Proposal Generator" />
          </div>

          <div class="color-picker-group">
            <label style="width:100px; font-weight:800; font-size:13px; color:#334155;">Primary</label>
            <input type="color" id="primaryColor" value="#1e3a8a" />
          </div>
          <div class="color-picker-group">
            <label style="width:100px; font-weight:800; font-size:13px; color:#334155;">Secondary</label>
            <input type="color" id="secondaryColor" value="#3a8bff" />
          </div>

          <button class="save-btn" onclick="saveBranding()">Save Branding</button>
          <div class="save-message save-success" id="brandingSuccess">‚úì Branding saved successfully!</div>
          <div class="save-message save-error" id="brandingError">‚úó Error saving branding</div>
        </div>

        <!-- Settings -->
        <div class="admin-card">
          <h3>‚öôÔ∏è Settings</h3>
          <div class="form-group">
            <label>Custom Domain (optional)</label>
            <input type="text" id="customDomain" placeholder="proposals.youragency.com" />
          </div>
          <div class="form-group">
            <label>Agency Name</label>
            <input type="text" id="agencyName" placeholder="Your Agency Name" />
          </div>
          <div class="form-group">
            <label>Plan</label>
            <p style="margin:0; padding:10px; background:#f1f5f9; border-radius:8px; color:#334155; font-weight:800;">White-Label Pro ‚Äî $349/month</p>
          </div>

          <button class="save-btn" onclick="saveSettings()">Save Settings</button>
          <div class="save-message save-success" id="settingsSuccess">‚úì Settings saved successfully!</div>
          <div class="save-message save-error" id="settingsError">‚úó Error saving settings</div>
        </div>
      </div>

      <!-- Preview -->
      <div class="admin-card" style="margin-top: 20px;">
        <h3>üëÅÔ∏è Preview</h3>
        <div style="border:1px solid #e2e8f0; border-radius:8px; padding:16px; background:#f8fafc; text-align:center;">
          <h2 id="previewTitle" style="margin:0 0 6px; font-size:22px; font-weight:900; color:#1e3a8a;">ScopeBuilderAI</h2>
          <p id="previewTagline" style="margin:0; color:#64748b; font-weight:700;">Professional Proposal Generator</p>
        </div>
      </div>
    </div>
  </div>

 <!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

<!-- Initialize Firebase (must be right after SDKs) -->
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDadaImEVf-rdcEPlza_UR3Kp--52wQbhI",
    authDomain: "scopebuilderai.firebaseapp.com",
    projectId: "scopebuilderai",
    storageBucket: "scopebuilderai.firebasestorage.app",
    messagingSenderId: "471021428025",
    appId: "1:471021428025:web:8246535fe30b2854701ce8"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();
  const storage = firebase.storage();
</script>

<!-- Your app code that uses auth/db/storage goes after this -->
<script>
  // Example: onAuthStateChanged, login handler, save functions...
</script>



  <script>
    // Your Firebase config (inserted)
    const firebaseConfig = {
      apiKey: "AIzaSyDadaImEVf-rdcEPlza_UR3Kp--52wQbhI",
      authDomain: "scopebuilderai.firebaseapp.com",
      projectId: "scopebuilderai",
      storageBucket: "scopebuilderai.firebasestorage.app",
      messagingSenderId: "471021428025",
      appId: "1:471021428025:web:8246535fe30b2854701ce8"
    };

    // Init
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    const storage = firebase.storage();

    let currentUser = null;
    let currentAgencyId = null;

    auth.onAuthStateChanged(async (user) => {
      if (user) {
        currentUser = user;
        currentAgencyId = user.uid;
        document.getElementById('authSection').style.display = 'none';
        document.getElementById('adminDashboard').style.display = 'block';
        await loadAgencyData();
      } else {
        document.getElementById('authSection').style.display = 'block';
        document.getElementById('adminDashboard').style.display = 'none';
      }
    });

    // Login
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();
      try {
        await auth.signInWithEmailAndPassword(email, password);
        document.getElementById('authError').textContent = '';
      } catch (err) {
        document.getElementById('authError').textContent = err.message;
      }
    });

    async function logout() { await auth.signOut(); }

    // Load agency doc
    async function loadAgencyData() {
      try {
        const snap = await db.collection('agencies').doc(currentAgencyId).get();
        if (snap.exists) {
          const d = snap.data();
          setVal('siteTitle', d.siteTitle || 'ScopeBuilderAI');
          setVal('tagline', d.tagline || 'Professional Proposal Generator');
          setVal('primaryColor', d.primaryColor || '#1e3a8a');
          setVal('secondaryColor', d.secondaryColor || '#3a8bff');
          setVal('agencyName', d.agencyName || '');
          setVal('customDomain', d.customDomain || '');
          if (d.logoUrl) {
            const img = document.getElementById('logoImg');
            img.src = d.logoUrl; img.style.display = 'block';
            document.getElementById('logoPlaceholder').style.display = 'none';
          }
          updatePreview();
        } else {
          // create an empty doc so updates succeed
          await db.collection('agencies').doc(currentAgencyId).set({
            siteTitle: 'ScopeBuilderAI',
            tagline: 'Professional Proposal Generator'
          }, { merge: true });
        }
      } catch (e) {
        console.error(e);
      }
    }

    function setVal(id, val){ const el=document.getElementById(id); if(el) el.value=val; }

    // Save branding
    async function saveBranding() {
      try {
        let logoUrl = '';
        const file = document.getElementById('logoFile').files[0];
        if (file) {
          const ref = storage.ref(`logos/${currentAgencyId}/${file.name}`);
          await ref.put(file);
          logoUrl = await ref.getDownloadURL();
        }
        await db.collection('agencies').doc(currentAgencyId).set({
          siteTitle: document.getElementById('siteTitle').value.trim(),
          tagline: document.getElementById('tagline').value.trim(),
          primaryColor: document.getElementById('primaryColor').value,
          secondaryColor: document.getElementById('secondaryColor').value,
          ...(logoUrl && { logoUrl })
        }, { merge: true });
        updatePreview();
        flash('brandingSuccess');
      } catch (e) {
        flash('brandingError');
      }
    }

    // Save settings
    async function saveSettings() {
      try {
        await db.collection('agencies').doc(currentAgencyId).set({
          agencyName: document.getElementById('agencyName').value.trim(),
          customDomain: document.getElementById('customDomain').value.trim()
        }, { merge: true });
        flash('settingsSuccess');
      } catch (e) {
        flash('settingsError');
      }
    }

    function previewLogo() {
      const file = document.getElementById('logoFile').files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        const img = document.getElementById('logoImg');
        img.src = e.target.result; img.style.display = 'block';
        document.getElementById('logoPlaceholder').style.display = 'none';
      };
      reader.readAsDataURL(file);
    }

    function updatePreview() {
      document.getElementById('previewTitle').textContent = document.getElementById('siteTitle').value;
      document.getElementById('previewTagline').textContent = document.getElementById('tagline').value;
      document.getElementById('previewTitle').style.color = document.getElementById('primaryColor').value;
    }

    function flash(id){
      const el = document.getElementById(id); if(!el) return;
      el.style.display='block'; setTimeout(()=>el.style.display='none', 1800);
    }

    function toggleSignUp(){
      alert('For now, create your first user in Firebase Console ‚Üí Authentication ‚Üí Users ‚Üí Add user. Sign-up UI will be added later.');
    }
  </script>
</body>
</html>
